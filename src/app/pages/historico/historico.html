<h2>Histórico de Viagens</h2>
<hr>

@if (isMotorista) {
  <h4>Como Motorista</h4>
  @if (historicoMotorista.length > 0) {
    <ul class="list-group mb-4">
      @for(viagem of historicoMotorista; track viagem.id) {
        <li class="list-group-item">
          <div>
            <strong>{{ viagem.origem }} → {{ viagem.destino }}</strong>
            <span class="badge float-end" [ngClass]="{'bg-danger': viagem.situacao === 'CANCELADA', 'bg-secondary': viagem.situacao === 'FINALIZADA'}">
              {{ viagem.situacao }}
            </span>
          </div>
          <div class="text-muted small">
            Data: {{ viagem.dataInicio | date:'dd/MM/yyyy HH:mm' }}
          </div>
        </li>
      }
    </ul>
  } @else {
    <div class="alert alert-info">
      Você não possui viagens no seu histórico como motorista.
    </div>
  }
  <hr>
}

<h4>Como Passageiro</h4>
@if (historicoPassageiro.length > 0) {
  <ul class="list-group">
    @for(item of historicoPassageiro; track item.id) {
      <li class="list-group-item">
        <div class="d-flex justify-content-between align-items-start">
          <div>
            <h5 class="mb-1">{{ item.viagem.origem }} → {{ item.viagem.destino }}</h5>
            <div class="small text-muted">
              <div>
                Motorista: <strong>{{ item.viagem.motoristaNome }}</strong>
              </div>
              <div>
                Início: <strong>{{ item.viagem.dataInicio | date:'dd/MM/yyyy HH:mm' }}</strong>
              </div>
              @if(item.dataConfirmacao) {
                <div>
                  Finalizada em: <strong>{{ item.dataConfirmacao | date:'dd/MM/yyyy HH:mm' }}</strong>
                </div>
              }
            </div>
          </div>

          @if(item.situacao === 'FINALIZADA') {
            <button (click)="avaliar(item)" class="btn btn-outline-primary btn-sm ms-3">Avaliar</button>
          }

        </div>
        <div class="mt-2">
          <span class="badge" [ngClass]="{'bg-secundary': item.situacao === 'CONFIRMADA', 'bg-success': item.situacao === 'FINALIZADA', 'bg-danger': item.situacao === 'CANCELADA'}">
            {{ item.situacao }}
          </span>
        </div>
      </li>
    }
  </ul>
} @else {
  <div class="alert alert-info">
    Você não possui viagens no seu histórico como passageiro.
  </div>
}
